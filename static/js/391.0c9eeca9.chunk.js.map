{"version":3,"file":"static/js/391.0c9eeca9.chunk.js","mappings":"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","sources":["apis/Article.js","apis/getChannels.js","hooks/useChannels.js","pages/Article/columns.js","pages/Article/index.jsx"],"sourcesContent":["import request from '@/utils/request'\r\n\r\n// 获取文章\r\nexport const fecthArticle = (params) => {\r\n  return request.get('/mp/articles', {\r\n    params,\r\n  })\r\n}\r\n\r\n// 删除文章\r\nexport const deleteArticle = (id) => {\r\n  return request.delete(`mp/articles/${id}`)\r\n}\r\n\r\n// 获取文章详情\r\nexport const getArticleDateil = (id) => {\r\n  return request.get(`mp/articles/${id}`)\r\n}\r\n\r\n// 更新文章\r\nexport const edidArticle = (id, data) => {\r\n  return request.put(`/mp/articles/${id}?draft=false`, data)\r\n}\r\n","import request from '@/utils/request'\r\n\r\n// 获取频道\r\nexport const fetchChannels = async () => {\r\n  return request.get('/channels')\r\n}\r\n","import { useState, useEffect } from 'react'\r\nimport { fetchChannels } from '@/apis/getChannels'\r\n\r\nconst useChannels = () => {\r\n  const [channels, setChannels] = useState([])\r\n  // 获取频道\r\n  useEffect(() => {\r\n    const getChannels = async () => {\r\n      const { data } = await fetchChannels()\r\n      setChannels(data.channels)\r\n    }\r\n    getChannels()\r\n  }, [])\r\n  return {\r\n    channels\r\n  }\r\n}\r\n\r\nexport default useChannels\r\n","import { Space, Button, Popconfirm, Tag } from 'antd'\r\nimport { EditOutlined, DeleteOutlined } from '@ant-design/icons'\r\nimport img404 from '@/assets/error.png'\r\nimport { useNavigate } from 'react-router-dom'\r\n\r\n// 准备列数据\r\nconst useColumns = (delFn) => {\r\n  const navigate = useNavigate()\r\n  const columns = [\r\n    {\r\n      title: '封面',\r\n      dataIndex: 'cover',\r\n      width: 120,\r\n      render: (cover) => {\r\n        return (\r\n          <img src={cover.images[0] || img404} width={80} height={60} alt='' />\r\n        )\r\n      },\r\n    },\r\n    {\r\n      title: '标题',\r\n      dataIndex: 'title',\r\n      width: 220,\r\n    },\r\n    {\r\n      title: '状态',\r\n      dataIndex: 'status',\r\n      render: (data) =>\r\n        data === 2 ? (\r\n          <Tag color='success'>审核通过</Tag>\r\n        ) : (\r\n          <Tag color='warning'>待审核</Tag>\r\n        ),\r\n    },\r\n    {\r\n      title: '发布时间',\r\n      dataIndex: 'pubdate',\r\n    },\r\n    {\r\n      title: '阅读数',\r\n      dataIndex: 'read_count',\r\n    },\r\n    {\r\n      title: '评论数',\r\n      dataIndex: 'comment_count',\r\n    },\r\n    {\r\n      title: '点赞数',\r\n      dataIndex: 'like_count',\r\n    },\r\n    {\r\n      title: '操作',\r\n      render: (data) => {\r\n        return (\r\n          <Space size='middle'>\r\n            <Button\r\n              type='primary'\r\n              shape='circle'\r\n              icon={<EditOutlined />}\r\n              onClick={() => navigate(`/publish?id=${data.id}`)}\r\n            />\r\n            <Popconfirm\r\n              title='确认删除该条文章吗?'\r\n              onConfirm={() => delFn(data)}\r\n              okText='确认'\r\n              cancelText='取消'\r\n            >\r\n              <Button\r\n                type='primary'\r\n                danger\r\n                shape='circle'\r\n                icon={<DeleteOutlined />}\r\n              />\r\n            </Popconfirm>\r\n          </Space>\r\n        )\r\n      },\r\n    },\r\n  ]\r\n  return {\r\n    columns\r\n  }\r\n}\r\n\r\nexport default useColumns\r\n","import { Link } from 'react-router-dom'\r\nimport {\r\n  Card,\r\n  Breadcrumb,\r\n  Form,\r\n  Button,\r\n  Radio,\r\n  DatePicker,\r\n  Select,\r\n  Table,\r\n  message,\r\n} from 'antd'\r\n// 引入中文包\r\nimport locale from 'antd/es/date-picker/locale/zh_CN'\r\nimport useChannels from '@/hooks/useChannels'\r\nimport { useEffect, useState } from 'react'\r\nimport { deleteArticle, fecthArticle } from '@/apis/Article'\r\nimport useColumns from './columns'\r\nconst { Option } = Select\r\nconst { RangePicker } = DatePicker\r\n\r\nconst Article = () => {\r\n  // 获取频道\r\n  const { channels } = useChannels()\r\n\r\n  // 文章列表\r\n  const [articleList, setArticleList] = useState({\r\n    list: [],\r\n    count: 0,\r\n  })\r\n\r\n  // 获取文章列表的参数\r\n  const [ariclesParams, setAriclesParams] = useState({\r\n    page: 1,\r\n    per_page: 4,\r\n    begin_pubdate: null,\r\n    end_pubdate: null,\r\n    status: null,\r\n    channel_id: null,\r\n  })\r\n\r\n  // 列表刷新更新页面\r\n  const getList = async (params) => {\r\n    const { data } = await fecthArticle(params)\r\n    setArticleList({ list: data.results, count: data.total_count })\r\n  }\r\n\r\n  // 初始化文章列表\r\n  useEffect(() => {\r\n    getList(ariclesParams)\r\n  }, [ariclesParams])\r\n\r\n  // 筛选文章\r\n  const onFinish = (formV) => {\r\n    setAriclesParams({\r\n      ...formV,\r\n      status: formV.status,\r\n      begin_pubdate: formV.date?.[0].format('YYYY-MM-DD') || null,\r\n      end_pubdate: formV.date?.[1].format('YYYY-MM-DD') || null,\r\n    })\r\n  }\r\n\r\n  // 切换页码\r\n  const pageChange = (v) => {\r\n    setAriclesParams({\r\n      ...ariclesParams,\r\n      page: v,\r\n    })\r\n  }\r\n\r\n  // 删除文章\r\n  const delArticle = async (data) => {\r\n    await deleteArticle(data.id)\r\n    getList(ariclesParams)\r\n    message.success('删除成功')\r\n  }\r\n\r\n  // 获取 列 数据\r\n  const { columns } = useColumns(delArticle)\r\n\r\n  return (\r\n    <div>\r\n      <Card\r\n        title={\r\n          <Breadcrumb\r\n            items={[\r\n              { title: <Link to={'/'}>首页</Link> },\r\n              { title: '文章列表' },\r\n            ]}\r\n          />\r\n        }\r\n        style={{ marginBottom: 20 }}\r\n      >\r\n        <Form initialValues={{ status: '' }} onFinish={onFinish}>\r\n          <Form.Item label='状态' name='status'>\r\n            <Radio.Group>\r\n              <Radio value={''}>全部</Radio>\r\n              <Radio value={0}>草稿</Radio>\r\n              <Radio value={2}>审核通过</Radio>\r\n            </Radio.Group>\r\n          </Form.Item>\r\n\r\n          <Form.Item label='频道' name='channel_id'>\r\n            <Select placeholder='请选择文章频道' style={{ width: 120 }}>\r\n              {channels.map((item) => {\r\n                return (\r\n                  <Option key={item.id} value={item.id}>\r\n                    {item.name}\r\n                  </Option>\r\n                )\r\n              })}\r\n            </Select>\r\n          </Form.Item>\r\n          <Form.Item label='日期' name='date'>\r\n            {/* 传入locale属性 控制中文显示*/}\r\n            <RangePicker locale={locale}></RangePicker>\r\n          </Form.Item>\r\n          <Form.Item>\r\n            <Button type='primary' htmlType='submit' style={{ marginLeft: 40 }}>\r\n              筛选\r\n            </Button>\r\n          </Form.Item>\r\n        </Form>\r\n      </Card>\r\n      {/* 筛选文章列表 */}\r\n      <div>\r\n        {/*    数据渲染    */}\r\n        <Card title={`根据筛选条件共查询到 ${articleList.count} 条结果：`}>\r\n          <Table\r\n            rowKey='id'\r\n            columns={columns}\r\n            dataSource={articleList.list}\r\n            // 页码\r\n            pagination={{\r\n              current: ariclesParams.page,\r\n              pageSize: ariclesParams.per_page,\r\n              onChange: pageChange,\r\n              total: articleList.count,\r\n            }}\r\n          />\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Article\r\n"],"names":["fecthArticle","params","request","get","deleteArticle","id","delete","concat","getArticleDateil","edidArticle","data","put","useChannels","channels","setChannels","useState","useEffect","async","fetchChannels","getChannels","delFn","navigate","useNavigate","columns","title","dataIndex","width","render","cover","_jsx","src","images","height","alt","Tag","color","children","_jsxs","Space","size","Button","type","shape","icon","EditOutlined","onClick","Popconfirm","onConfirm","okText","cancelText","danger","DeleteOutlined","Option","Select","RangePicker","DatePicker","Article","articleList","setArticleList","list","count","ariclesParams","setAriclesParams","page","per_page","begin_pubdate","end_pubdate","status","channel_id","getList","results","total_count","useColumns","message","success","Card","Breadcrumb","items","Link","to","style","marginBottom","Form","initialValues","onFinish","formV","_formV$date","_formV$date2","date","format","Item","label","name","Radio","value","placeholder","map","item","locale","htmlType","marginLeft","Table","rowKey","dataSource","pagination","current","pageSize","onChange","v","total"],"sourceRoot":""}